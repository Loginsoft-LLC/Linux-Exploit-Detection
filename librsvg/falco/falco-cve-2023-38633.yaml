- required_engine_version: 26

- macro: check_process_librsvg
  condition: (proc.name contains rsvg-convert)

- rule: Directory traversal vulnerability in librsvg CVE-2023-38633, Exploit Detection
  desc: Possible CVE-2023-38633, Directory traversal vulnerability in librsvg. 
  condition: >
    evt.dir=< and 
    check_process_librsvg and 
    syscall.type=read and 
    evt.arg.data contains 'xi:include' and 
    evt.arg.data contains '../' and 
    evt.arg.data contains 'xi:fallback'
  enabled: true
  output: "CVE-2023-38633 exploit attempt detected (user.name=%user.name user.loginuid=%user.loginuid proc.exeline=%proc.exeline proc.name=%proc.name proc.cwd=%proc.cwd container.id=%container.id evt.args=%evt.args)"
  priority: CRITICAL
  tags: [host, container, exploit, CVE_2023_38633, librsvg, Mitre_Initial_Access, T1068, T1083]
