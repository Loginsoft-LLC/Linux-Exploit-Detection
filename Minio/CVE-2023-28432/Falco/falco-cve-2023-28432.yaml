- required_engine_version: 17


- macro: read_socket CVE_2023_28432
  condition: evt.type=read and (fd.typechar='4' or fd.typechar='6')

- macro: write_socket
  condition: evt.type=write and (fd.typechar='4' or fd.typechar='6')

- rule: MinIO Information Disclosure Vulnerability CVE-2023-28432
  desc: Detect possible exploit for MinIO Information Disclosure Vulnerability CVE-2023-28432
  condition: >
    evt.dir=< and
    write_socket and
    proc.name=minio and
    evt.arg.data contains '200 OK' and
    evt.arg.data contains '"MinioEndpoints"'
  output: "Detect possible exploit for MinIO Information Disclosure Vulnerability CVE-2023-28432 (user.name=%user.name user.loginuid=%user.loginuid proc.exeline=%proc.exeline proc.name=%proc.name proc.cwd=%proc.cwd container.id=%container.id evt.args=%evt.args)"
  priority: CRITICAL
  tags: [host, container, exploit, CVE_2023_28432, ,minio, Mitre_Initial_Access, T1552]


- rule: MinIO Information Disclosure Vulnerability CVE-2023-28432
  desc: Detect possible exploit for MinIO Information Disclosure Vulnerability CVE-2023-28432
  condition: >
    evt.dir=< and
    read_socket and
    proc.name=minio and
    evt.arg.data contains 'POST' and
    evt.arg.data contains 'bootstrap/v1/verify'
  output: "Detect possible exploit for MinIO Information Disclosure Vulnerability CVE-2023-28432 (user.name=%user.name user.loginuid=%user.loginuid proc.exeline=%proc.exeline proc.name=%proc.name proc.cwd=%proc.cwd container.id=%container.id evt.args=%evt.args)"
  priority: WARNING
  tags: [host, container, exploit, CVE_2023_28432, ,minio, Mitre_Initial_Access, T1552]
