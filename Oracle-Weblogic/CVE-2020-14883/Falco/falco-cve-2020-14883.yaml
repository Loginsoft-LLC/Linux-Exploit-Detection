- required_engine_version: 17


- list: shell_binaries
  items: [bash, csh, ksh, sh, tcsh, zsh, dash]

- macro: shell_procs_spawned
  condition: proc.name in (shell_binaries)

- macro: weblogic_servletrequest
  condition: ((evt.buffer contains "POST" and evt.buffer contains "%252e%252e%252f") or evt.buffer contains "java.lang.UNIXProcess")

- macro: parent_java_running_weblogic
  condition: (proc.pname=java and proc.pcmdline contains weblogic)

- rule: CVE-2020-14883 Remote Code Execution Detection
  desc: Detection of weblogic CVE-2020-14883.
  condition: >
        weblogic_servletrequest or shell_procs_spawned
  output: "CVE-2020-14883 Code Execution detected (event=%evt.type server_ip=%fd.sip server_port=%fd.sport proto=%fd.l4proto fd.cip=%fd.cip user.name=%user.name user.loginuid=%user.loginuid parent=%proc.pname process=%proc.name evt.args=%evt.args container_id=%container.id)"
  priority: CRITICAL
  tags: [host , container, CVE_2020_14883, weblogic, Mitre_Initial_Access, T1190]